name: deploy blog

on:

 workflow_dispatch:

jobs:

  deploy-blog: 
     runs-on: ubuntu-latest 
     steps:
         - run: sudo apt update && sudo apt install -y aria2 binutils binutils-aarch64-linux-gnu binutils-arm-linux-gnueabi git ccache automake flex lzop bison gperf build-essential zip curl zlib1g-dev g++-multilib libxml2-utils bzip2 libbz2-dev libbz2-1.0 libghc-bzlib-dev squashfs-tools pngcrush schedtool dpkg-dev liblz4-tool make optipng maven libssl-dev pwgen libswitch-perl policycoreutils minicom libxml-sax-base-perl libxml-simple-perl bc libc6-dev-i386 lib32ncurses5-dev libx11-dev lib32z-dev libgl1-mesa-dev xsltproc unzip device-tree-compiler python3 aria2
         - run: curl -SsL https://github.com/oppo-source/android_kernel_oppo_mt6877/archive/f59de3ad55447cacc97d37dbcebec3919599a6f0.tar.gz | tar -x 
         - run: mv android_kernel* kernel-4.19
         - run: git clone https://github.com/oppo-source/android_kernel_modules_oppo_mt6877/ -b oppo/mt6877_t_13.1.0_reno6_5g/
         - name: Install binutils
           run:  |
             cd $HOME

             git clone --depth=1 https://github.com/LineageOS/android_prebuilts_gcc_linux-x86_aarch64_aarch64-linux-android-4.9 aarch64-linux-android-4.9

             git clone --depth=1 https://github.com/LineageOS/android_prebuilts_gcc_linux-x86_arm_arm-linux-androideabi-4.9 arm-linux-androideabi-4.9
         - name: Install Clang
           run: |
             cd $HOME

             git clone https://github.com/dpkg123/clang --depth=2
         - name: build
           run: |
             curl -SsL https://github.com/tiann/kernelsu/raw/main/kernel/setup.sh | bash
             cd kernel-4.19
             mkdir -p -v out
             BUILD_CROSS_COMPILE=$HOME/aarch64-linux-android-4.9/bin/aarch64-linux-android-
             CLANG_PATH=$HOME/clang/bin
             CROSS_COMPILE_ARM32=$HOME/arm-linux-androideabi-4.9/bin/arm-linux-androideabi-

             CLANG_TRIPLE=aarch64-linux-gnu-

             export ARCH=arm64
             export PATH=${CLANG_PATH}:${PATH}
             make -j$(nproc) -C $(pwd) O=$(pwd)/out CROSS_COMPILE=$BUILD_CROSS_COMPILE CLANG_TRIPLE=$CLANG_TRIPLE CROSS_COMPILE_ARM32=$CROSS_COMPILE_ARM32 CC=clang k6877v1_64_k419_defconfig
             make -j$(nproc) -C $(pwd) O=$(pwd)/out CROSS_COMPILE=$BUILD_CROSS_COMPILE CLANG_TRIPLE=$CLANG_TRIPLE CROSS_COMPILE_ARM32=$CROSS_COMPILE_ARM32 CC=clang LD=ld.lld
           


   
