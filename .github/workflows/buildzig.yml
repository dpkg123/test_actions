name: build zig

on:

  workflow_dispatch:
  push:

jobs:
  build-rootfs:
    runs-on: ubuntu-22.04
    permissions:
      contents: read
    steps:

    - name: clean
      uses: rokibhasansagar/slimhub_actions@main
        
    - name: "Checkout Repo"
      uses: actions/checkout@v4
      with: 
        repository: ziglang/zig-bootstrap
        fetch-depth: 2
    - name: Install package
      run: sudo apt update && sudo apt -y install cmake ninja-build python3-pip python3
        
    - name: Checkout build files
      uses: actions/checkout@v4
      with:
        repository: dpkg123/zig-debian
        fetch-depth: 2
        path: debian

    - name: Build
      run: |
        rm build
        cp debian/build.sh ./build
        sudo dpkg-buildpackage -b -us -uc
