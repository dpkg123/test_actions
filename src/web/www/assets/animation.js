// Copyright (C) Microsoft Corporation. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
const t=200,n=t=>Array.isArray(t),i=t=>"function"==typeof t,e=t=>"number"==typeof t,s=t=>t?.constructor===Object;function r(t){return t?i(t)?r(t()):n(t)?t.map(r).flat():t instanceof NodeList||t instanceof HTMLCollection?[].slice.call(t):[t]:[]}export default function(o={}){function a(n){const{targets:i,delay:e=0,duration:s=t,easing:a="ease-out",...u}={...o,...n};return Promise.all(r(i).map((t=>new Promise((n=>{const i=t.style.transition;t.style.transition=`${s}ms ${a} ${e}ms`;let r=!1;const o=e=>{e?.currentTarget===e?.target&&(r||(r=!0,t.removeEventListener("transitionend",o),t.style.transition=i,n()))};t.addEventListener("transitionend",o),setTimeout((()=>o()),s+e+20),Object.keys(u).forEach((n=>{t.style[n]=u[n]}))})))))}return{items:[],running:!1,add:function(t){return this.items.push(t),this},delay:function(t){return this.add(t)},totalDuration:function(){let i=0;const r=n=>n.duration||o.duration||t;for(const t of this.items)e(t)?i+=t:n(t)?i+=t.reduce(((t,n)=>Math.max(t,r(n))),0):s(t)&&(i+=r(t));return i},pause:function(){return this.running=!1,this},isRunning(){return this.running},isFinished(){return 0===this.items.length},run:async function(){if(!this.running){for(this.running=!0;this.running;){const t=this.items.shift();if(void 0===t)break;i(t)?await t():e(t)?await new Promise((n=>setTimeout(n,t))):n(t)?await Promise.all(t.map(a)):s(t)&&await a(t)}this.running=!1}}}}